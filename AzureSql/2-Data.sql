/****** Object:  Table [dbo].[SinhVien]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SinhVien](
	[MSSV] [int] IDENTITY(1,1) NOT NULL,
	[TenDangNhap] [nvarchar](20) NOT NULL,
	[Ten] [nvarchar](20) NULL,
	[Ho] [nvarchar](20) NULL,
	[Pass] [nvarchar](20) NULL,
	[NgayThangNamSinh] [datetime] NULL,
	[GioiTinh] [int] NULL,
	[SoDienThoai] [nvarchar](15) NULL,
	[QueQuan] [nvarchar](20) NULL,
	[Anh] [image] NULL,
	[Tucach] [int] NULL,
	[Deleted] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MSSV] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[GiangVien]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[GiangVien](
	[MSGV] [int] IDENTITY(1,1) NOT NULL,
	[TenDangNhap] [nvarchar](20) NOT NULL,
	[Ten] [nvarchar](20) NULL,
	[Ho] [nvarchar](20) NULL,
	[Pass] [nvarchar](20) NULL,
	[NgayThangNamSinh] [datetime] NULL,
	[GioiTinh] [int] NULL,
	[SoDienThoai] [nvarchar](15) NULL,
	[QueQuan] [nvarchar](20) NULL,
	[Anh] [image] NULL,
	[Tucach] [int] NULL,
	[Deleted] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[MSGV] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[AdminSys]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AdminSys](
	[MSAD] [int] IDENTITY(1,1) NOT NULL,
	[TenDangNhap] [nvarchar](20) NOT NULL,
	[Ten] [nvarchar](20) NULL,
	[Ho] [nvarchar](20) NULL,
	[Pass] [nvarchar](20) NULL,
	[NgayThangNamSinh] [datetime] NULL,
	[GioiTinh] [int] NULL,
	[SoDienThoai] [nvarchar](15) NULL,
	[QueQuan] [nvarchar](20) NULL,
	[Anh] [image] NULL,
	[Tucach] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[MSAD] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  View [dbo].[view_BangDangNhap]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[view_BangDangNhap]
as
	SELECT TenDangNhap, Pass, MSSV, Tucach, Deleted FROM dbo.SinhVien 
		UNION 
	SELECT TenDangNhap, Pass, MSGV, Tucach, Deleted FROM dbo.GiangVien 
		UNION 
	SELECT TenDangNhap, Pass, MSAD, Tucach, 0 FROM dbo.AdminSys
GO
/****** Object:  View [dbo].[view_allP]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[view_allP]
AS
	SELECT MSSV, TenDangNhap, Ten, Ho, Pass, NgayThangNamSinh, GioiTinh, SoDienThoai, QueQuan, CAST(Anh AS VARBINARY(MAX)) AS Anh, Tucach, Deleted FROM dbo.SinhVien 
		UNION 
	SELECT MSGV, TenDangNhap, Ten, Ho, Pass, NgayThangNamSinh, GioiTinh, SoDienThoai, QueQuan, CAST(Anh AS VARBINARY(MAX)) AS Anh, Tucach, Deleted FROM dbo.GiangVien 
GO
/****** Object:  Table [dbo].[LopHoc]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LopHoc](
	[MaLop] [int] IDENTITY(1,1) NOT NULL,
	[MaGV] [int] NULL,
	[MaMH] [int] NULL,
	[HocKy] [char](5) NULL,
	[NamHoc] [char](15) NULL,
	[SiSo] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[MaLop] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[LopSinhVien]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LopSinhVien](
	[MaLop] [int] NOT NULL,
	[MaSV] [int] NULL,
	[DiemTK] [float] NULL,
	[DiemGK] [float] NULL,
	[DiemCK] [float] NULL,
	[DiemTongKet] [float] NULL,
	[XepLoai] [char](5) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MonHoc]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MonHoc](
	[MaMH] [int] IDENTITY(1,1) NOT NULL,
	[TenMH] [nvarchar](70) NULL,
	[TinChi] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[MaMH] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET IDENTITY_INSERT [dbo].[AdminSys] ON 

INSERT [dbo].[AdminSys] ([MSAD], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach]) VALUES (2, N'admin', N'admin', N'system', N'pass', CAST(N'2018-10-26T19:47:42.600' AS DateTime), 1, N'', N'', NULL, 2)
SET IDENTITY_INSERT [dbo].[AdminSys] OFF
SET IDENTITY_INSERT [dbo].[GiangVien] ON 

INSERT [dbo].[GiangVien] ([MSGV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (1, N'longlong441', N'Long', N'Đỗ Văn', N'111111', CAST(N'1967-03-04T00:00:00.000' AS DateTime), 1, N'0123457889', N'TP. HCM', 0x89504E470D0A1A0A0000000D49484452000000640000007C0802000000100582F5000000097048597300000B1200000B1201D2DD7EFC0000115F49444154789CED5C7D6C1BE7792779BC3B92471E3F2C8A92185994A9CA662C4BF6FCB14459EC186DACFC51A48E53B42856A34E310C0DD23F3220C5800143BD3F566048B6657F780E166CB3EB021ED6D4760B178D952D71E458B52D67D6871DC90A29D3A2A890A64CF1EBC4E3F1EE389C8EA6289247DEC77B9202E8074138F2DEF7E1F3FEEE799EF7793FEED5160A05CD26C441B7C993786C9225019B6449C0265912B04996046C9225019B6449807E43699389F9E95C46A3D124C263350B187097C1D2A247CD6667D79A6BB7AE6491A948223C4AA6A289B951321521D35149D5CD4D5EB3B3CBF6549FCDBDDB80B7A8A6E60AD63A83A773998599CF12736389B9FF23D3315062CD4DDEA7F6BCDAE27B0994C09A583BB21273A391C92B91C92BEAFD84C1E2EA3AF84693F7CF5492BF166425E6468337CF0A8521E068F10DEC78F1AFD590AC6ECCA27399E0CDB373A3BF51F5572AC01BAF1A7CA9485626E69FFAE81F320B01F57E420891C92B06BCC5F3A73F022B56AD3C2B13F38FFEE6AFD685291E9CE3CF8D8295A90A593C533445A8215C3C8237CF8215089E2C3215D9084CF1996D64F2438002C19375F7F2DF6E04A678046F80342EC064F9874EAD639CAA06998E02EC8B41929589F9D7384BA8864E07B95C5EA7D30341087F3378E30C3FDE04201CA0A2FEA15300A5C90004C13D3BBFB9AD736F97F7C0CEA75F80F42897EB5104A847088CACC4DCE89AE5E83581A2A69D4F1FC6301B7F13C36C3BBA9FE5AFE7EE7C00C4B88091B5BE0E88996CBDBB064A4CF1C0F166A7EB1BBC712DCC7CA6FC57C09045A6220B33D781889201A7D3D3DB7B44AF87ABAB366F71F3177377003C4B3064AD175310046FEF7EAECB7B40A8008E37A3069CEB7C1602642AA2F0E7C09015B9F77B20722401C79D7DBD471C0E77FD4AB8C5C15F287FA200C8225391CCE3A07239E20141B0A763F7CEA70FA328D6B092156FE62F940F1501CC3A24C280C7ABF5E1747A3C1D7B6A46A89A30998A517F43909589AD51CA8EE34E4FC79E8A2EAF214AE5698AC8C4FC4A563A0090958E4E2917521F38EE6C7F6A27FEC4A164544FA5627CC45867B2925FDD532E44084EA7A7B5A55BAA355540FF64E89359082899A1574A56757F8C6176DCD284A218CDE463B107B9DC920CB1286A6A6DE9763A3BC5C7A63A3061B6F862989FE65622073059286AEADDF5224DE7830FEFC46292BB48143539EC6EA7B353A12955400F1519CFC4FC8AE428D4834CAF220BC79B63B1E083E01D86C98B9480A226CC64C771A7C3E116930AC80028EA955BD6AA656493C94AE6082BDE4C331443E789A544F95D088279BD31930DD22356DC89A2984A04A901C0AB3B66CC2EBBCF520FA5E7A1D00D01CF946E40A6CAC95238DFADD4B2EAF42F049160188A20127459FCB2E24E084214061182482C2D25C85C65CBF5CB6EAEDE03534A56B961E3B893BFA813E3E796FF4310EC70B89B9D1E490DA3E9FC5791E986E90804C15DDE030D07D832A0CA8A344D531866CBE508A156315C0A168CC5820EBB7BFBF6E7C4C8CCE588B1F1C13A9D6CA9F7C0F16620D959359492657B6A77F56C726B6B776B6B77E9632AF588BF48A68A7B8C9638DFA4385A192A972344768856BCD9F4C47FF54FA8111928211865F239716D1204885907A290200A0F622C8E33BFBE713593E558C864A999F9C59AE53103EC7573734C2E87B9C581D148A6AFAB315953A1CC78D01C8927A3712E4A06C27182AC6D65DBDAEC662337BE311B11AFDBAED1687ABD2D94CE0969E60C169792962ADD72F4CB777EFAEF97EE547C59A2A3AF6B45B94C960A8439FAA2F14C74B13236BF7270C7F1813EBE91E5C864A97357C62E0E558ED55D76CCE5306B341AAFDB5E5E6BCC1F15A2F2E801FDE1E7FE64F7ABFF2CBBB1F22DAB4093F9FB9763F3A1F22F8F0FF4F6F7B4F34CD547201C1F0B44C7FDD1E1BB9C848B435363FEE8EB47F757543A7D69A464A1FD3DEDBD5DAE3EAFAB8EFCE303C58B40383E7C3774EECA78E9568228B04B0B059AD4EA0DF29A2C9F2CEADE076C6216825624ECF15A8F0FF489ACEE753BBC6EC7B183BE683CF3F6F9E1F14074667EF167FF3A58B370AFD7F5B31FF4F3A624497E244E7C34B232DD06B11435F62B74EF5F8897530E9949693E788D4DCC6A349A677DAE169B96FF724F979CECC9E5309FFCF10B2EBB60D872D931AE8014A64A28C581169BD6E7864C060B9B79940F5E93214A2659059A64C2B7F86B8F0B7BED306233717C75B4CACC06CD46A47F57BBD0DDFE5DEDD5B14C245C76334FF76B8791169B56BFEC074CF8568126654893E386ECC274812E76C3B8D96E8035CF74431F8ED2302C3316F07CF13D43FFAEAD47F67B351ACDE0486078629620F3B2992AE195433E033CC18DF38D96E5879D6317A6A1965EA9726491955935D38022C6CE662EF98461A35095C191C0E98B235C007EA9EFD8419F50B12307BCA518DFD7E53A6D84ABFBC1122E0C4D9EFB904BF15E7F653FCFAF10BADBB0F482867FB47C1126F150065972DC90252AC832F0612B301FAF593E1ACFBC737E9820F304997FEFD2ED40B846313E3BAB6833FF91BF55814038FEDEA5DBBCCC77CE0FF3C9578D62CB2A6D6D3694CC8A47219794D17000B30E168C7B5C3BDA71A256ABB825D8F8AAAC2A93AD914C0E4F84B6B5D9F99C204F157DDCEB766C6BB30F4F84AACB5708A9F88912882CD5EB75110437AD866376A94DAB801CB2B4A8B5FC23B6FCC4BC6E3B9F1056A3AFCB55EAEC96F3D54AA5F934F5D8A1A27BE6A915D28F1DF24517896AC3F1BAED98A1380074D9B1F2ECB71C63FEA8D76DA7694EA0D3D12AD404919013B3205B07139D287DE403C17E5FE7EF6F5C15AAF2CE1B470697F39D23FBBDD501FBC2D02417DA7BDACBCD8A477F4F3B66802F0C4D56E4AB6623F2DE5BDF2EC914FADDF140F4D8415F2AF5256EB697BBA1CE2C67DC23872C5D53B73680963A4408D2776CEDC1ED2E3E90D754DDE5300BE5AB992C35782B70EC908F2791C9D3E577CD46E4D821DF854F27AB07437564F2E0A9ECED723D9CF9D2EDDA567E4B467497EB867A03E45EB571A5B5B993CB957ADA076F495E9D3E77656C796C58F4419ACE574CB0F0B7F8629230782BD0DFC3E5684F6F7FB6D40F7206D2F1BCBC118FCC000F7B9ED7D9B6AE7C6619BE55E38168CD782C8440387E7168EAF84B2B5693A7725A9DB6BCB8D9881C7FA9EFE2D054CD6E5408C313A1F140B4F80C5876A5C1E666D8F3BCBC56CBEF0D919DDF855CBBF8EB4281E103797F4FFBDBE7AF8BE46BCC1F7DEBD460AFD755CABC588661190646D08A92C70EFA7ABDAEB74E0D0AF52115189E08BD7DFE7A7F4F7B31F0178A64414DDD48DF0F65355703608A864D3CA4C323CCC2B4CEE8E003D0C9FFB83A1E88F214080D62862742D7EF863E1A09BCB8DFFBFAD17D25B3220922BB94B13B6B44DF4C963A7DE9365FE5B99EF63A922F0C4DF20A9CFCF10BBC64361B879ABAF5EEFD3A5B8792C6027B858EBAFB41616981BF1E1C095CF874929F5AE9F5BAF89E7ED9E916F949C1D2B0A6A2CB4F2F728E66B10BCEC08CF9A3A561103FC95792CCF77DFCE4DFB143BE523FA3355891DE1F00692330B2E8D9EB4C64A2FC1B7EB62F301F2F4F56BD6D0E9703AB39215560D9F8A30866B11AB0C613A781703C1A27CAC70C9811F1B6392AE602975D6FBB7EDB61B9CD5A056064B18B0FF25F2A7A4B35975DCA2413B8634B75CC5202FDD67E7989423580ADEEE8F036851248A2386429CF4B9513A7B3772A945002B8A53008D59AB614961ECBAB9DA77234CD0DF752F14A09086AA813C5EA438B5AB4A8455EDD6A805CBE879AB6CBAEABD5EA10B446A2A8D5EAB43AF94AEAEC1ED975AB0172919533F8D961997AC0306F3E2CC3304C71C4A3D7C34A9852F8FCAA01D2B2B4A84567111BB9589A6669BAFA7B1D04C108CAFF09314567454D0A733E686A12A98F1800DE45A3734A78928F2767B27169937074968CDE9914AB0C50B3024F16D4B45D6440D5E9F55B7CDB1603B3B1896931964267C9D8C474E4CEA4BD6BABDE2862180C21FA965DA294160DF08760300BF7E9994FC4974F3E9C5FF4CF1A1D5653B3C3E8B05610C1D234117DBCF4289E8D27AD1D6D564F9B4E2F2ACE42EE7D7AF73EE9EAD7832A278650777F2D35874887A33C235CAE801733782A45B0346D7058B1E62D1677B3489A34CB6685EEFE730D0432B9558B2C36359F9FFA9DBCBA7496CC678B49296C4445795C150066EDE550EB2C1A3A7C9B09DF56437243E82C6DB0EF655524AB21947BB6EE7DE2D308908010B87B4025D92A1E6307770F684D5BD4935F031082F85E061EAA4A50F3CC3F08457C2FAF1D5FCB4C81CD422BA0FEF9594C2E3FF309BBA8EEDB9B5AD4027F634055A6D6EE643626324E876F6B98DA4BD60AA1B37BE06D87D5F3BE12D6EE18BB422ECD846F330BF701CAD4A216FDD67E8033560D7E6E8D0F48E4288B8E33B1FB0AAD4C6769D339B7839D546888753B0F9E4DCDB3890705E2319B9E175B074274781B4793BD13E0949E78ACDB39A53ABCED954FB23065F641D8DF58FEA8D16AB570EDA05360590D933F45ECBB41718791A60BFA7F7911DDA17A80AA817523EB7FE7083FA12516C9823E53307213CA857C3DC7FC6384BCB9C48D1C2D4DADBFBC9FFCC533CE3554B688753B5BF9DC14D77214C3BF651175B42B5F0C31623A08FAED4C3A4CD49838541BEB43D648343BF2889BC3D223688F45D43BAF3FB287FEAE75DA6429EEAB3A3551FBF50D55B13E64FDD3E8CAE2E83F2E55BE28208434B2A5A02D2AFC71884853ACC88AA0B0D6649DB91BDFFD9FF76E4556DE16FB92715CA61A9FB5902E20E7732B3B77D379F6F4B8CC6537D958A3D42198A4DEFD3C76E65E3C99E3F6DBB4D98C36D3CA26AC565DE677D6064736FD5B76F7FBE4AAAD6B5FCCA7AC287462A7E3CDBD4E8F55E9F66F31509DAC4BFEE4BB9FC73E0DADDA146A33C16DB655FBC07F8E5DFF3622F80273BA80BC9C7C35535861648962820B2B9B6EBFD3653DD1E338DA2567A7A878A8455622C79CB91B7FF7F3D8C3548D84C00043DB9CAB767FD437AE6AB38AA573B174E5FB831D38F2E65EE7891E870D8514B7A006C093154C5227872397FC49DEE384B0A3C5A25BBDC3EF0DE4E609ACC62B02F729EB0F89A3155F86E24B69B276F66045A1A35DD693FD2DC07D136480BF1ACA9CF8C36CE7FB5F9C7D129BEA80A457F5652CC3FE2A547BA7D1470BC644A27279718912949FCC3167EFC53BDFFFE2C41F66471F6595B7AB0430197C304DFDE47FC2570212564C891C6D428ACE4292E4C3E02CC340491AB2EA2B59B896B4CC3FE6C68F365B3124E51996611B3BC4D97BF1B3F7E2035EEB7BDF727B2C00AC0C80659D995AEC3C377D25949654AB641A24995B668AFB3894C4AB4B7E92E0389A0FCF97EC8B6864B6E5B8124A779E9B3E33052089554AD6A507A9D73EE60E10D240D244917986FFFF304131469B66F900D6FF5AA87C09EF5A1227189D4607690C9679A21027A8525DB15856ECB58FC3971EA414365651804FE418CFB9E964297C908C46847794D06235C4D2B91587A273563633BF67A8BCCCF7FDBD97D3AD1AC454FAC66682C93C2B962F9D5663283ABB158182C7BB9574948A2CEBCDCFBE4A9607DAD5BD5B434492E4AAD0A34793C896BF7FB492A65F239A2EE7BCE54C714F68292FC1B2CA544A52CC9B9F7D2549C34A61B26B2672CCD9FBAB0E3102D2B5FE22B6E31AC1AD3B2419F87BA167948A5BADD2D9FB89849478575798149C994A540993665942F8CBF0DE24037F3FF44C8A517CF047954A35D4160DF9316BF77FFBC716AAB60A2D819966C2A13C00A6B837322B73A3BE26C3E8F7649E9128D3B28269AA0653E08C0B0C53B594195B208369996B2532C9BA1A1638880A10596020A08CA0F28D009C2C351A2D1702CAAC3559A38F0536366A379265092823A87C23C824AB76C0FA9AB8A1A0F20DE5C9A853CF8CB5CB7F1B01753591E78972C86AD09B6C104FACAB86BC0E511E597517AF36488CAFAB468326C8112980D1FA3EFF75B0AC064D10801CB21A0CAF36488CAFAB86BC11A21A962543A40AA8ABC6DA59565278FE5BF335B1AC064D101229B58228035E77BA442820C313259325CA80D73DC68B50408627AAD3CFAFBB27AAA380E4A5300F0EFF7C7F83B3FD82895C30C1657D2FB8D7FAAC773E35F7D8108FADC1DE400F2E791668DDF6947E1DB1A1A654363A36C992804DB22460932C09D8244B0236C992804DB2C442A3D1FC3F4C0E25F05AC3893A0000000049454E44AE426082, 1, 0)
INSERT [dbo].[GiangVien] ([MSGV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (2, N'hoahoa111', N'Hoa', N'Nguyễn Văn', N'222222', CAST(N'1955-03-24T00:00:00.000' AS DateTime), 0, N'0254852291', N'TP. HCM', NULL, 1, 0)
INSERT [dbo].[GiangVien] ([MSGV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (3, N'nhantrong33', N'Nhân', N'Nguyễn Trọng', N'nt3311', CAST(N'1990-04-17T00:00:00.000' AS DateTime), 1, N'015151151515', N'Phan Thiết', NULL, 1, 0)
SET IDENTITY_INSERT [dbo].[GiangVien] OFF
SET IDENTITY_INSERT [dbo].[LopHoc] ON 

INSERT [dbo].[LopHoc] ([MaLop], [MaGV], [MaMH], [HocKy], [NamHoc], [SiSo]) VALUES (1, 1, 1, N'HK1  ', N'2018-2019      ', 57)
INSERT [dbo].[LopHoc] ([MaLop], [MaGV], [MaMH], [HocKy], [NamHoc], [SiSo]) VALUES (2, 1, 2, N'HK1  ', N'2018-2019      ', 30)
INSERT [dbo].[LopHoc] ([MaLop], [MaGV], [MaMH], [HocKy], [NamHoc], [SiSo]) VALUES (3, 2, 3, N'HK1  ', N'2018-2019      ', 80)
INSERT [dbo].[LopHoc] ([MaLop], [MaGV], [MaMH], [HocKy], [NamHoc], [SiSo]) VALUES (4, 2, 7, N'HK2  ', N'2018-2019      ', 5)
SET IDENTITY_INSERT [dbo].[LopHoc] OFF
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (1, 1, 10, 10, 10, 10, N'A    ')
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (1, 2, 5, 5, 7, 6, N'C    ')
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (2, 1, 0, 0, 0, 0, N'D    ')
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (2, 2, 0, 0, 0, 0, N'D    ')
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (2, 4, 5, 0, 0, 1, N'D    ')
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (3, 2, 0, 0, 0, 0, NULL)
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (3, 3, 0, 0, 0, 0, NULL)
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (4, 1, 0, 0, 0, 0, N'D    ')
INSERT [dbo].[LopSinhVien] ([MaLop], [MaSV], [DiemTK], [DiemGK], [DiemCK], [DiemTongKet], [XepLoai]) VALUES (4, 2, 0, 0, 0, 0, N'D    ')
SET IDENTITY_INSERT [dbo].[MonHoc] ON 

INSERT [dbo].[MonHoc] ([MaMH], [TenMH], [TinChi]) VALUES (1, N'Lý Thuyết đồ thị', 4)
INSERT [dbo].[MonHoc] ([MaMH], [TenMH], [TinChi]) VALUES (2, N'Ngôn ngữ học', 4)
INSERT [dbo].[MonHoc] ([MaMH], [TenMH], [TinChi]) VALUES (3, N'Tư tưởng Hồ Chí Minh', 2)
INSERT [dbo].[MonHoc] ([MaMH], [TenMH], [TinChi]) VALUES (7, N'Lập trình hướng đối tượng Java', 4)
INSERT [dbo].[MonHoc] ([MaMH], [TenMH], [TinChi]) VALUES (8, N'Toán A2', 2)
SET IDENTITY_INSERT [dbo].[MonHoc] OFF
SET IDENTITY_INSERT [dbo].[SinhVien] ON 

INSERT [dbo].[SinhVien] ([MSSV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (1, N'quanghuy124', N'Huy', N'Nguyễn Quang', N'123456', CAST(N'1998-06-07T00:00:00.000' AS DateTime), 1, N'0908371511', N'Ninh Thuận', 0x89504E470D0A1A0A0000000D49484452000000640000007C0802000000100582F5000000097048597300000B1200000B1201D2DD7EFC000010A549444154789CED5D7B6C1B477A9F5D2E976F4A14295212AD2715CB5225DA96653B96125FDC384AEEECA6EEE58026B8F8726853C481734581EB5DDA22280AB445CF8DD1CBF571BE030AF40E97C207C4760CC7F1B9B672761C59712C3F143F44D927C992224AA444F125525C725F05B90A45AE283E76878F1CF483FED81DCD7E3BF39B6FBEF9E69BD921C2B22C58477640D779CA1EEB64E58075B272C03A5939609DAC1C8015F1DDFD17CF0D7DD6DFDF77EE6F8EFCD7969D3D0EFB9463FA8BA1CFFA0100DC35976DCBCE1E00805A5BD6DCDA51B5A1B6CA5C57AC0217C175E8BF78AEBFEFC3FE8BE7828B7E0080C95CFBC4DE6FF4F79D73DABFC852C2E61D3D5B76F634B7766CD9D9A3D69665F348C0EF0B2CFA44125D38B21CF6A9F3278F9F3F753C7B52B28165537B735B7B95B9AEB9B5234E5C4C31A70000A3B6BB01BFFFF3EB570100AF7CEF87DFFDCB37C5BCAB10DDD0619FFAC5BF1FF9BF53BFCE87F0B1917B6323F7B2C9B965E71322DF9577B2CE9F3A7EE4CD37F2FD966C50B5A156A484FC8E86A5C354942C73DDD067575F7C6A8BC33E254C421E6D56493165D9D45EB5A1F66ADF6F0000977EB7204C48BEC81AB5DDFDAB6F3FCF8D77250593B9F6D797878495285FDDF0473F7CA30499E23AA3E067C51AF880DFF7A3370F73EACD61F38E1E6E901229394F1063E6C592A5D696FDD3B177476D77CF9F3CCE39969C5353B2E034EBFCA9E30080E7BEF9524EC584D60D476DF7E07A9B7942FFC573FB3B1B8FBCF9865A9395EB9F080806BEA446BD2C21CCCC8BD5ACAF2253000061F31E519A35F4D9D5B75E7F999BD006FCBE93BFFCB96051858460EF019A9F15F0FBFE685B53B1EA9F137EFCEE192EEC932BA019F8FFFCE7BFCB7B2D61E085575E13C61434CD72D8A75E7A6A2BEC7AC1876553FB7F7FF0B160B17034EBC4FFFC2C5FF58307CBA6F677FEF78C187170346B7F6763694E6EE2D094E9FEED57EF37B77688110241B3E201E252064D532299824316B7C450E2580A2CF65F3C570A6495F464308E51DB5D9112C49215F0FB4A36C0C083F846154BD6A82D35537FFBC69F76B4368A142E0C464379995695AAA8C5D6AC942578E6C9CEAFEDB2BEFDD6ABFFFAD6AB05A6ACA9AEFAA7FFF2BD3DDD9B57FF4BFC2804A11BAE4E3CF0F56EEEC2DADAF8F65BAFFEF29DBF3EF05CB74A2917F9AE6C303E35FBADBFF8C7F1A9D9947945F644B1C1BFD59A6534945BEAAB13534C95BA4307F71D3AB86FE0C6F0A7376C033787834B84C8F7A647204054946BDCDE45B862C58795F9BA7DF085A7D7CADCDDD5D6DDD5F67DF0C2D8E4ECA737863FB73DBA6B7B945EBE4A29CF8959A3A1BC7777E7CB2F3CFDB35F7D78FAFC40F60F6603C88BAC2AA5FC99DD9D19B359EAAB2DF5D52FC7AEC72667C72767C7627FE393B33C6A544AF9A183FB000077861F4533ACD1BF544A79F7B6B65D5DADDD5D6D5C8AB5B5B1D4C9EADED696EB231C71CF24A4DC89A9DBD8E46C3018020038E73D07BEDE136F03E7BCC7E9F2264A3019CA4D953A7E49BA722E49464026CBDA0661ECB3C60650EB1AC3A8A952B79A9A94E8686DCCD8CD7302E475C3B56A58146C865D1898641953758722C2DA0639720B932C9EC750744057F3DF67B238871EA234986435951E5950069C38608E863C83150845C6EC1EA727E07407B814873B18BF8602B502B798575E6AB55445ED7AB3299E0257D9C5EF75D0C6AFB99239DD810B836357EF7E31E1F049A5B84C2EC3318956AD6496C3D7D2787E09C2CE7B03344585C3618AA2321414C3A452A94AA9D069140C0B68160100F84976C6EF96202C8A00CF62E8C495DF51144D9211ABC5D4BBC3D2DD5E0B57D9C592D5DCDAC16DA1311ACA01001706C78EBD3F8848E546BDAEC6AC89678B30299EA558A0FD72CB2C4B93B30EE791437B13F58213F8931337CCD5468A5DB618213A851C00805CA9962BD5D12A49106F98FC8F53B78EBD3F78F470AFC80A2642ACCD6223CBDDCA54A9BB3038F6CE7BD74D55D5E5E5BAC8AA2AA50722911AF4FA0B8363BC5CA73EB62532950D289A6510ACD2683418F43FF8695FF3C60407828E88A9AC28B268C71D7AF636776DA828FFF9995B353535B9D214875CA1586DD1C6673C393195543C04D7E90DCE88229EB22138C0049C02CB27862CC63B197970367EEB0A631A6D1923625D8D61018FAC40282293898A82B1888442E5AC6CD920A87024F2F9BB2C912206970D04DA2C962222F74F444D953E667410C9A385B0562FD67D777A82878E9E552BF0E55B1843676545F9A4BB0C4496004BC74A1E8E3CF840B6F96501A20492454D0FB2543836E3D7B2CA0A56630CD3705CB6F1194FE2AD48CD8A16154858999A353E867896777433DE29C63B8996D7E72A4A2059B4F3CECA0D0AD3B33DF6FD7D16730577CD0D85B024EB12563128FB209E3B5942EAC912BE78B737E9CB90800B5D9810208707098A9874AA3853D198547B2D498A1ABF38A8A400758DD5EA65F114C63B29408E30B256626F2643CC29A520C4D411963655A81353D40A5C2597E2182252B25A89039A4C4CE16C48AE80D0839A6A2B9BEA4C32A958516EDF22CF238DCD5DAA2871CA2597A20A5954A7AC2D499BBA05281704B28CFA329542D660D26491371D424BA1EE76FE26F5EE8EDA058FA8F53E86A6FEA0B132DA1915B2C47444CD6F988C10441696344259EA2A2D75468B5987B042FD5100301454A8A57183150E2D7117DDEDB5A150084385F7C439B76F7B5B74EFBB7553524B2058CEE3AC10B250B509C1565AA9A3A576D7D68D9B2D551E9F701598772D1C7C6E791999A1A3E0AED50AFCE96D8D9188709B488442D666D31FEFED6CAA35AE54A15CC8472902BB21AADF18BFB6B6D476B498BB3B6A555256980A606874D616EF83349D1481F8CEB3D6B9F90581921166CFD67AB55CFADA8B7B92D24D5601D20492256DD89D74CF46A30A079FB506024216819D73F3AFFFC9F6B8E34E462228B2523053857ACFD67A7FAA7D021931EB74F56EB78064FB80C8CB50C34601D2049285C8CBA496BDBCC4DEED16AD0CA0486EF3C37028F8588D365AA52F4145C2126992B7FCFA81AE702888B219625E3C3054F81B3B1B568FB078CB7E01064BD468886DD881D53FB9721FDB9BFA83977679DD0BD9F79808115A0AF8FFE1CF9E4A4C2423118924892CB5023F7AB8777AC691FD1882B08C1C210F3ECBDF4E83B7EC1730D1E120CA7590363C29DBFC6D441E9B4BC7AA6131571C796D8FD7ED42D854E1BE64F8FD3E845A3A7AB837DE01634C45DD455422E165B6982BFEFE95DD6ED75C3814CC2899210929B374F4F0339C6496A138A32EDBF6E7922A21D68A039CDDCA4CC0498DF5B1E165831508458E9DBE3130EC30E82BB8F86F222428125A5A727B3C7BB6D6BF7EA02B91A9E82E2ABF8FA6486D8521E58B9CEEC0DBC7078627178C957A1C9753C921210C45183AE2F3F99FEFB624EA14A2A996363EB5DCA82200ED73146AFC12ED7AC0ABD8A92BB651BBE7E1F48A6D6618A6B652B5B9D9F4CDDDADBCC90D07CFBC1397C955698FB6F87CD47961706CCCEEFE623E887E398D9749D10693A6BBA3B677BB85D700585DB718858A031A59B4EB01357E49A4108A247D0BF3EAB272994209A5541CF0F66F21CAD4AA9A13A0455724BA06F14238C75D8ACBB2C89B2D1099060A5350D70D253289A185D713734538148AF9DC4B89CF49715C0C7D288C56E40073911515475638B4C4C6C6D050B2671B020041D00A539530B11241CE7A4AC00C72A2DA1A545323F8715C2657A835521C4FF41B302CBA4EAB2E2B1758245D0322131B0E59290C2C411C24E62E6644E09757088A2AD51A00A0D50DAE5AC1DFCC1655AEAC6D041522A8909070024351D93C88EA1A50AD704D4F2110A22C0E585D0F90E059E554C87D9333BEC9999CE42FDA9D8EDB364C91697227C1A325810AF86421320D569F6D29F59B9A18929ABA32B868CFBC50BC68774E5D198C2C066BB667FE180E337741B4561CF27570CF6A873E0D228B41D7C878C41F54192B9426BD4CA38A2B4E643118F60708B72F38E7C6B52A9DA54E519179D62231B4604D7B3266CB15793C128AB49D611673E862548808CEB909B72FBC18A042CBAB2F98428629E40A5D99CAA4C735293E5F5A0D44A9C75B9F0712989E2D877C9EF9478723B633EC92C0C3AA84217F4CE5FF80443A4C8E5F623C109660B3415E992AD06992D4D455DA21F65BBF8C40750DD2A63DF963AA70476F329E47E4F825917BC9D24062EEC2CC5D79121E47010F75A5C3D4E480C899F66AA09A1AACBE1B565C213D0A7D022E1B5EA4ED37A0508628F598B90BD515EE0398E2FCD2409432D703C6F5201E89CE01125CA26B440D2D70A732D9A0983FCB601BBEA7C1288DF79E2CE242A43280A45B140A4B7514A689487521A9A1D1F258018BB982A29DDAED98B17FF2DB0BD3F69927EAF127EA9737C723D214934A96A601431FBD32CADD3635369495EB2AF48530523C14ED3CF8A19BD7711C57C8E5F284F662C9C8EA3FC04417D94CEA685135EAE81AC7F05D81078D8A4471C80A2CFA1DB3F6E8D98E95BA0E5356DADD6596CA3144A78B4601471F8E048A71FA4D71C81ABA799DBB4030998BCC6A25BDC384EDEBD06118C69350481481AC8723C3A30F47E2B7B7BD594D8F01000F022B39271F8DE7A1681950B8D1902088C14FAFDE19BAE9F37AABAAABD0843DCE3B2A161B5419229F1341F975F74A7C8AA669995CB96357CFC64DF03F1C5F0B85180D2727C6EFDCBE7577E8563C8522295CB632F0DDF32BD3934532C86D6FD2F23549924EC7A3A9894765E5E5D62DDBB6EFEA91CBF37E22491E358B208887B6E1EBD7AECE39F8873168B41A8D26298C995EB9EEFB54F7FD496BD43E9F2F1848DA21D2B1A5D3BAB5B3BE218F275AE6852C9FD7733DDAE36E8589D4F597C9647A833E314589D1FBABDD2933930C7276564F32492EEB826B211C4EB13DDB5855BDE3F11EEBD6CC0771080064B256F7B8944051B4AA9ABF68FA98746E6B550A277E609A9D668DBCC4197BBA186C9EFA2634B29C8ED98BBF393B3591EDA11395C64AA974E5ABD619FB4C151E7AB153BB3AE72FAEFBBC8CB2C6BC32138C84232E972BE32B6472F98EC77B205206C1C01344E8F489F7C6C71E0226F306B63848928C9335639FF17A7DA135BEA49870930044372DC5F9224932654E1EC204F1C9E58F3EF9E4E33FDCDBFB78B7D89F4681E067396667DE79FBC8886D98A672DB041F0947B8ED5AF373F3BED89EF030C53AFCFC5DA323CEE578A1DFBF383F37CF5DA7B456695E74FEC3B3A74FBE9753F152422C59A74FBE47C4AC38936377264992619805D70249925AAD46A954A0283A30C967E1A63D82A2A852A9D06A3524497A3DDEEC35EBCB8DAE510CDDBA796D40ECA997A2C8BAFC519F63769657AC2C419224C754D47022088EE35AAD668EC0C209BA15A6803B8C69B51A1C5F76CA969696E6E7E6E39F14644462135EFEA8CFEBF1E454481E84934510215E5B09502EBE4C1AFD787285880F1E5234C2DF899BBD5AF19A902088CBBFEDCBA9843C08276BE8D64D22D98D8232AE0ECF3363EEE840716D9A9EF68B95C86BBF91E1FB0411122C4D1459BC14581EDB8531FADA347D6D3A87B13525561787208891E161C1020592E5F578E2D62A8E5CBBE15A08D3403C53B1C64B519E91E1FB82050A246BC426FC950543CAB61BB1155CB326C65387934AEA47A9D72ACC84D0589850B2D6781FAC9E08056C0AAB05D2B474460821CBEBF1106B84134AEAD7CE4B42B31CB36BCFF84B86AD342A9EAEFC69218CACD427AB9654375CAB0F720E84306F0BB666950CD2B75A9AF64E032164AD65B03894886EA52F86B049A210B2D21BC8921A10D742E1C8FA4A207D9B79BD05212BA3C1FA2A2856A1342BBDC14A3F0C150C191BAC40A32111CAF09A52D0AC8C0D56A0D1309BD7149DAE3C35587E0C7CB1D9CA862C013DB198DB24BF72F8BD751DF28175B272C03A5939609DAC1CB04E56B60000FC3F48A0152F557E52330000000049454E44AE426082, 0, 0)
INSERT [dbo].[SinhVien] ([MSSV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (2, N'hau76411', N'Hậu', N'Đỗ Minh', N'234567', CAST(N'1998-04-01T00:00:00.000' AS DateTime), 1, N'0733112549', N'An Giang', NULL, 0, 0)
INSERT [dbo].[SinhVien] ([MSSV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (3, N'binhpham1214', N'Bình', N'Phạm Thái', N'345678', CAST(N'1998-12-14T00:00:00.000' AS DateTime), 1, N'5151515510', N'Thái Bình', NULL, 0, 0)
INSERT [dbo].[SinhVien] ([MSSV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (4, N'maingoc444', N'Ngọc', N'Mai Thị', N'456789', CAST(N'1998-07-02T00:00:00.000' AS DateTime), 0, N'851151555', N'Ðồng Tháp', NULL, 0, 0)
INSERT [dbo].[SinhVien] ([MSSV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (5, N'quocdung555', N'Dũng', N'Mai Quốc', N'777777', CAST(N'1998-03-04T00:00:00.000' AS DateTime), 1, N'01521515151', N'TP. HCM', NULL, 0, 0)
INSERT [dbo].[SinhVien] ([MSSV], [TenDangNhap], [Ten], [Ho], [Pass], [NgayThangNamSinh], [GioiTinh], [SoDienThoai], [QueQuan], [Anh], [Tucach], [Deleted]) VALUES (6, N'TuanCui', N'Tuấn', N'Bùi Quốc', N'333', CAST(N'1998-12-03T00:00:00.000' AS DateTime), 1, N'07331522552', N'Hà Tĩnh', NULL, 0, 0)
SET IDENTITY_INSERT [dbo].[SinhVien] OFF
ALTER TABLE [dbo].[GiangVien] ADD  DEFAULT ((0)) FOR [Deleted]
GO
ALTER TABLE [dbo].[LopSinhVien] ADD  DEFAULT ((0)) FOR [DiemTK]
GO
ALTER TABLE [dbo].[LopSinhVien] ADD  DEFAULT ((0)) FOR [DiemGK]
GO
ALTER TABLE [dbo].[LopSinhVien] ADD  DEFAULT ((0)) FOR [DiemCK]
GO
ALTER TABLE [dbo].[LopSinhVien] ADD  DEFAULT ((0)) FOR [DiemTongKet]
GO
ALTER TABLE [dbo].[SinhVien] ADD  DEFAULT ((0)) FOR [Deleted]
GO
ALTER TABLE [dbo].[LopHoc]  WITH CHECK ADD FOREIGN KEY([MaGV])
REFERENCES [dbo].[GiangVien] ([MSGV])
GO
ALTER TABLE [dbo].[LopHoc]  WITH CHECK ADD FOREIGN KEY([MaMH])
REFERENCES [dbo].[MonHoc] ([MaMH])
GO
ALTER TABLE [dbo].[LopSinhVien]  WITH CHECK ADD FOREIGN KEY([MaLop])
REFERENCES [dbo].[LopHoc] ([MaLop])
GO
ALTER TABLE [dbo].[LopSinhVien]  WITH CHECK ADD  CONSTRAINT [FK_Masv] FOREIGN KEY([MaSV])
REFERENCES [dbo].[SinhVien] ([MSSV])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[LopSinhVien] CHECK CONSTRAINT [FK_Masv]
GO
ALTER TABLE [dbo].[LopHoc]  WITH CHECK ADD CHECK  (([HocKy]='HK3' OR [HocKy]='HK2' OR [HocKy]='HK1'))
GO
ALTER TABLE [dbo].[LopSinhVien]  WITH CHECK ADD CHECK  (([XepLoai]='F' OR [XepLoai]='D' OR [XepLoai]='C' OR [XepLoai]='B' OR [XepLoai]='A'))
GO
/****** Object:  StoredProcedure [dbo].[sp_addNewClass]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_addNewClass]
	@magv INT,
	@mamh INT,
	@hk CHAR(5),
	@namhoc CHAR(15),
	@ss INT
AS
BEGIN
    INSERT dbo.LopHoc(MaGV, MaMH, HocKy, NamHoc, SiSo)
    VALUES(@magv, @mamh, @hk, @namhoc, @ss)
END
GO
/****** Object:  StoredProcedure [dbo].[sp_CapNhatDiem]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_CapNhatDiem] @tk FLOAT, @gk FLOAT, @ck FLOAT, @masv INT, @malop INT 
AS
BEGIN
    UPDATE dbo.LopSinhVien
	SET DiemTK = @tk, DiemGK = @gk, DiemCK = @ck
	WHERE MaLop = @malop AND MaSV = @masv
END
GO
/****** Object:  StoredProcedure [dbo].[sp_checkSVMaLopDaCo]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_checkSVMaLopDaCo] @MaLop INT, @MaSV INT 
AS
BEGIN
    IF @MaLop IN (SELECT MaLop FROM dbo.LopSinhVien WHERE MaSV = @MaSV)
		SELECT 1
	ELSE 
		SELECT 0
END
GO
/****** Object:  StoredProcedure [dbo].[sp_deleteuser]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_deleteuser] @maso INT, @tc INT AS
BEGIN
    UPDATE dbo.view_allP
	SET Deleted = 1
	WHERE MSSV = @maso AND Tucach = @tc
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetAllP]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetAllP] @d INT
AS
BEGIN
	IF @d IS NULL 
	BEGIN
	    SELECT * 
		FROM dbo.view_allP
	END
	ELSE
	BEGIN
	    SELECT * 
		FROM dbo.view_allP
		WHERE Deleted = @d
	END
	
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetAllPerson]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetAllPerson]
AS SELECT * FROM dbo.view_BangDangNhap
GO
/****** Object:  StoredProcedure [dbo].[sp_getAllSubject]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_getAllSubject] AS
BEGIN
    SELECT MaMH, TenMH, TinChi FROM dbo.MonHoc
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetClassFromSubject]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[sp_GetClassFromSubject] @maMH INT, @hk CHAR(5), @nh CHAR(15)
AS
BEGIN
    SELECT l.MaLop, g.Ten + ' ' + g.Ho AS HoTenGV, l.HocKy, l.NamHoc, l.SiSo, l.MaGV, m.TenMH
	FROM dbo.LopHoc l JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
					  JOIN dbo.GiangVien g ON g.MSGV = l.MaGV
	WHERE l.MaMH = @maMH AND l.HocKy = @hk AND l.NamHoc = @nh
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetClassInfo]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetClassInfo] @hk CHAR(5), @namhoc CHAR(15), @tc INT, @ms INT, @dadk INT 
AS
BEGIN
    IF @tc = 0 
		BEGIN
			IF @dadk = 1
				BEGIN
					SELECT ls.MaLop, m.TenMH, g.Ho + ' ' + g.Ten AS TenGV, l.HocKy, l.NamHoc, l.SiSo
					FROM dbo.LopSinhVien ls JOIN dbo.LopHoc l ON l.MaLop = ls.MaLop
											JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
											JOIN dbo.GiangVien g ON l.MaGV = g.MSGV
					WHERE ls.MaSV = @ms AND l.HocKy = @hk AND l.NamHoc = @namhoc
				END
			ELSE
				BEGIN
					SELECT l.MaLop, m.TenMH, g.Ho + ' ' + g.Ten AS hoten, l.HocKy, l.NamHoc, l.SiSo, COUNT(l.MaLop) AS DaDK
					FROM dbo.LopSinhVien ls RIGHT JOIN dbo.LopHoc l ON l.MaLop = ls.MaLop
											JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
											JOIN dbo.GiangVien g ON g.MSGV = l.MaGV
					WHERE l.MaLop NOT IN (SELECT MaLop FROM dbo.LopSinhVien WHERE MaSV = @ms)
					GROUP BY l.MaLop, m.TenMH, g.Ho + ' ' + g.Ten, l.HocKy, l.NamHoc, l.SiSo
				END
		END
	IF @tc = 1
		BEGIN
		    SELECT l.MaLop, m.TenMH, g.Ho + ' ' + g.Ten AS TenGV, l.HocKy, l.NamHoc, l.SiSo, l.MaMH
			FROM dbo.LopHoc l JOIN dbo.GiangVien g ON l.MaGV = g.MSGV
							  JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
			WHERE l.MaGV = @ms AND l.HocKy = @hk AND l.NamHoc = @namhoc
		END
END
GO
/****** Object:  StoredProcedure [dbo].[sp_getDSMon]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_getDSMon] @mamh INT
AS
BEGIN
    SELECT MaMH, TenMH, TinChi
	FROM dbo.MonHoc
END
GO
/****** Object:  StoredProcedure [dbo].[sp_getDSSV]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_getDSSV] @malop INT, @ma INT 
AS
BEGIN
	IF @ma IS NULL
		BEGIN
			SELECT s.MSSV, s.Ho + ' ' + s.Ten AS tenSV, ls.DiemTK, ls.DiemGK, ls.DiemCK, ls.DiemTongKet, ls.XepLoai
			FROM dbo.LopHoc l JOIN dbo.LopSinhVien ls ON ls.MaLop = l.MaLop
							  JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
							  JOIN dbo.SinhVien s ON ls.MaSV = s.MSSV
			WHERE l.MaLop = @malop
		END
    ELSE
		BEGIN
		    SELECT s.MSSV, s.Ho + ' ' + s.Ten AS tenSV, ls.DiemTK, ls.DiemGK, ls.DiemCK, ls.DiemTongKet, ls.XepLoai
			FROM dbo.LopHoc l JOIN dbo.LopSinhVien ls ON ls.MaLop = l.MaLop
							  JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
							  JOIN dbo.SinhVien s ON ls.MaSV = s.MSSV
			WHERE l.MaLop = @malop AND ls.MaSV = @ma
		END
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetHocKy]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetHocKy]
AS BEGIN
	SELECT DISTINCT HocKy
	FROM dbo.LopHoc
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetInfo]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetInfo] @tc INT, @ms INT
AS
	BEGIN
	    IF @tc = 0 SELECT * FROM dbo.SinhVien WHERE MSSV = @ms
		IF @tc = 1 SELECT * FROM dbo.GiangVien WHERE MSGV = @ms
		IF @tc = 2 SELECT * FROM dbo.AdminSys WHERE MSAD = @ms
	END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetMarkInfo]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetMarkInfo] @hk CHAR(5), @namhoc CHAR(15), @masv INT
AS 
BEGIN
    SELECT m.TenMH, ls.DiemTK, ls.DiemGK, ls.DiemCK, DiemTongKet, XepLoai
	FROM dbo.LopSinhVien ls JOIN dbo.LopHoc l ON l.MaLop = ls.MaLop
							JOIN dbo.MonHoc m ON m.MaMH = l.MaMH
	WHERE ls.MaSV = @masv AND l.HocKy = @hk AND l.NamHoc = @namhoc
END
GO
/****** Object:  StoredProcedure [dbo].[sp_GetNamHoc]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_GetNamHoc]
AS BEGIN
	SELECT DISTINCT NamHoc
	FROM dbo.LopHoc
END
GO
/****** Object:  StoredProcedure [dbo].[sp_getNumberClassOfGV]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_getNumberClassOfGV] @magv INT 
AS
BEGIN
    SELECT COUNT(*)
	FROM dbo.LopHoc l JOIN dbo.GiangVien g ON g.MSGV = l.MaGV
	WHERE l.MaGV = @magv
END
GO
/****** Object:  StoredProcedure [dbo].[sp_HuyHocPhan]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_HuyHocPhan] @MaLop INT, @MaSV INT 
AS
BEGIN
    DELETE FROM dbo.LopSinhVien
	WHERE MaLop = @MaLop AND MaSV = @MaSV
END
GO
/****** Object:  StoredProcedure [dbo].[sp_insertNewSinhVien]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_insertNewSinhVien]
	@TenDN NVARCHAR(20),
	@Ten NVARCHAR(20),
	@Ho NVARCHAR(20),
	@password NVARCHAR(20),
	@birthday DATETIME,
	@GioiTInh INT,
	@Sdt NVARCHAR(15),
	@QueQuan NVARCHAR(20),
	@Anh IMAGE,
	@TuCach INT
AS
BEGIN
    IF @TuCach = 0
		BEGIN
		    INSERT dbo.SinhVien(TenDangNhap, Ten, Ho, Pass, NgayThangNamSinh, GioiTinh, SoDienThoai, QueQuan, Anh, Tucach)
		    VALUES(@TenDN, @Ten, @Ho, @password, @birthday, @GioiTInh, @Sdt, @QueQuan, @Anh, @TuCach)
		END
	IF @TuCach = 1
		BEGIN
		    INSERT dbo.GiangVien(TenDangNhap, Ten, Ho, Pass, NgayThangNamSinh, GioiTinh, SoDienThoai, QueQuan, Anh, Tucach)
		    VALUES(@TenDN, @Ten, @Ho, @password, @birthday, @GioiTInh, @Sdt, @QueQuan, @Anh, @TuCach)
		END
END
GO
/****** Object:  StoredProcedure [dbo].[sp_InsertNewStudenttoClass]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_InsertNewStudenttoClass] @malop INT, @masv INT 
AS
BEGIN
    INSERT dbo.LopSinhVien(MaLop, MaSV)
	VALUES(@malop, @masv)
END
GO
/****** Object:  StoredProcedure [dbo].[sp_restoreuser]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_restoreuser] @maso INT, @tc INT 
AS
BEGIN
	IF @tc = 0
		UPDATE dbo.SinhVien
		SET Deleted = 0
		WHERE MSSV = @maso
	IF @tc = 1
		UPDATE dbo.GiangVien
		SET Deleted = 0
		WHERE MSGV = @maso
END
GO
/****** Object:  StoredProcedure [dbo].[sp_TimKiem]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_TimKiem] @loaiTK INT, @noidung NVARCHAR(20)
AS BEGIN
    IF @loaiTK=0 BEGIN
        SELECT MSSV, TenDangNhap, Ten, Ho, Pass, NgayThangNamSinh, GioiTinh, SoDienThoai, QueQuan, Anh, Tucach
        FROM dbo.view_allP
        WHERE MSSV=@noidung AND Deleted=0;
    END;
    IF @loaiTK=1 BEGIN
        SELECT MSSV, TenDangNhap, Ten, Ho, Pass, NgayThangNamSinh, GioiTinh, SoDienThoai, QueQuan, Anh, Tucach
        FROM dbo.view_allP
        WHERE Ten LIKE @noidung+'%' AND Deleted=0;
    END;
END;
GO
/****** Object:  StoredProcedure [dbo].[sp_updateClass]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_updateClass] 
	@malop INT,
	@magv INT,
	@mamh INT,
	@hk CHAR(5),
	@namhoc CHAR(15),
	@ss INT 
AS
BEGIN
    UPDATE dbo.LopHoc
	SET MaGV = @magv,
		MaMH = @mamh,
		HocKy = @hk,
		NamHoc = @namhoc,
		SiSo = @ss
	WHERE MaLop = @malop
END
GO
/****** Object:  StoredProcedure [dbo].[sp_updateSinhVien]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[sp_updateSinhVien]
	@ms INT,
	@TenDN NVARCHAR(20),
	@Ten NVARCHAR(20),
	@Ho NVARCHAR(20),
	@password NVARCHAR(20),
	@birthday DATETIME,
	@GioiTInh INT,
	@Sdt NVARCHAR(15),
	@QueQuan NVARCHAR(20),
	@Anh IMAGE,
	@TuCach INT
AS
BEGIN
	IF @TuCach = 0
		UPDATE dbo.SinhVien 
		SET TenDangNhap = @TenDN, 
			Ten = @Ten, 
			Ho = @Ho, 
			Pass = @password, 
			NgayThangNamSinh = @birthday, 
			GioiTinh = @GioiTInh, 
			SoDienThoai = @Sdt, 
			QueQuan = @QueQuan, 
			Anh = @Anh,
			Tucach = @TuCach
		WHERE MSSV = @ms
	IF @TuCach = 1
		UPDATE dbo.GiangVien 
		SET TenDangNhap = @TenDN, 
			Ten = @Ten, 
			Ho = @Ho, 
			Pass = @password, 
			NgayThangNamSinh = @birthday, 
			GioiTinh = @GioiTInh, 
			SoDienThoai = @Sdt, 
			QueQuan = @QueQuan, 
			Anh = @Anh,
			Tucach = @TuCach
		WHERE MSGV = @ms
END
GO
/****** Object:  Trigger [dbo].[sp_Updatediem]    Script Date: 11/11/2018 6:10:55 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TRIGGER [dbo].[sp_Updatediem]
ON [dbo].[LopSinhVien] FOR UPDATE, INSERT
AS BEGIN
	DECLARE @masv INT, @malop INT 
	SELECT @masv = i.MaSV, @malop = i.MaLop FROM Inserted i

	UPDATE dbo.LopSinhVien
	SET DiemTongKet = 0.2 * DiemTK + 0.3 * DiemGK + 0.5 * DiemCK
	WHERE MaLop = @malop AND MaSV = @masv

	UPDATE dbo.LopSinhVien
	SET XepLoai = 
			CASE 
				WHEN DiemTongKet < 5 THEN 'D'
				WHEN DiemTongKet >= 5 AND DiemTongKet < 7 THEN 'C'
				WHEN DiemTongKet >= 7 AND DiemTongKet < 9 THEN 'B'
				ELSE 'A'
			END
	WHERE MaLop = @malop AND MaSV = @masv
END 
GO
ALTER TABLE [dbo].[LopSinhVien] ENABLE TRIGGER [sp_Updatediem]
GO
/****** Object:  Trigger [dbo].[deleteuser]    Script Date: 11/11/2018 6:10:56 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TRIGGER [dbo].[deleteuser] ON [dbo].[view_allP] INSTEAD OF UPDATE AS
BEGIN
    DECLARE @ma INT, @tc INT 
	SELECT @ma = Inserted.MSSV, @tc = Inserted.Tucach FROM Inserted

	IF @tc = 0
		UPDATE dbo.SinhVien SET Deleted = 1 WHERE MSSV = @ma
	IF @tc = 1
		UPDATE dbo.GiangVien SET Deleted = 1 WHERE MSGV = @ma
END
GO
